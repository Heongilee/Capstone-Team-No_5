<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by TEMPLATED
http://templated.co
Released for free under the Creative Commons Attribution License

Name       : PlainLeaf 
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20130902

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
<link rel="stylesheet" type="text/css" href="applytrash.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
  <!-- <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script> -->

  <script>
  $(document).ready(function(){
    // 슬라이더 Enable... ------------- Not Working...
    $(".button").click(function(){
        //여기서 승인해줘야됨
      $(".align-right").hide();
    });
  });
  </script>
<title></title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900" rel="stylesheet" />
<link href="default.css" rel="stylesheet" type="text/css" media="all" />
<link href="fonts.css" rel="stylesheet" type="text/css" media="all" />

<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
<script>
  firebase.initializeApp({
    apiKey: "AIzaSyDfLG-WSkckQnW0m95_4Jz2lYH5mAlzIzo",
    authDomain: "capstone-no5.firebaseapp.com",
    databaseURL: "https://capstone-no5.firebaseio.com",
    projectId: "capstone-no5",
    storageBucket: "capstone-no5.appspot.com",
    messagingSenderId: "80279008633",
    appId: "1:80279008633:web:9f59fbcca33ef8a8cdaba8",
    measurementId: "G-EQ9RSJSGE6"
  });
</script>
</head>
<body>
<div id="header" class="container">
   <div id="logo">
      <h1><a href="index.html">강남구청</a></h1>
   </div>
   <div id="menu">
      <ul>
         <li class="active"><a href="index.html" accesskey="1" title="">Homepage</a></li>
         <li><a href="applytrash.html" accesskey="3" title="">대형폐기물 수거신청</a></li>
      </ul>
   </div>
</div>
<div id="featured" class="container">
  <!-- 내용들이 들어갈 것임. -->
</div>
<div id="copyright" class="container">
   <p>&copy; Untitled. All rights reserved. | Photos by <a href="http://fotogrph.com/">Fotogrph</a> | Design by <a href="http://templated.co" rel="nofollow">TEMPLATED</a>.</p>
</div>
<script>
  $(document).ready(function () {
    $('.bxslider').bxSlider();
    var db = firebase.firestore();
    var docRef = db.collection("reservation");
    var myAppendPosition = document.getElementById("featured");
    
    docRef.get().then(function (querySnapshot) {
      
      if(querySnapshot){
        var i = 0;

        // 이미지 태그를 참조할 문서 객체
        var myContents = document.getElementsByClassName('align-right-contents');
        // DB에 저장된 예약 내역 개수만큼 생성할 것임.
        querySnapshot.forEach(function (doc) {
          var myImgSlider = document.getElementsByClassName("bxslider");
          // container 클래스 'featured~' id값을 가지는 동적 div 태그 생성.
          var newDiv = document.createElement("div");
          newDiv.setAttribute("id", "featured" + i);
          newDiv.setAttribute("class", "container");

          // align-left 동적 태그 생성
          var newDiv_alignleft = document.createElement("div");
          newDiv_alignleft.setAttribute("class", "align-left");

            // slider 동적 태그 생성
            var newDiv_alignleft_slider = document.createElement("div");
            newDiv_alignleft_slider.setAttribute("class", "bxslider");
            newDiv_alignleft_slider.setAttribute("id", "bxslider" + i);
            newDiv_alignleft_slider.setAttribute("max-width", 400);
            newDiv_alignleft_slider.setAttribute("max-height", 300);

          // align-right 동적 태그 생성
          var newDiv_alignright = document.createElement("div");
          newDiv_alignright.setAttribute("class", "align-right");

            // align-right-contents 동적 태그 생성 : 여기에 상세 내역 표시.
            var newDiv_alignright_contents = document.createElement("div");
            newDiv_alignright_contents.setAttribute("class", "align-right-contents");
            
            // 승인하기 위한 a태그 생성
            var newDiv_alignright_button = document.createElement("a");
            newDiv_alignright_button.setAttribute("href", "#");
            newDiv_alignright_button.setAttribute("class", "button");
            newDiv_alignright_button.innerHTML = "승인하기";

          // 태그가 생성된 순서와 반대 순서로 Merge.
          newDiv_alignright.appendChild(newDiv_alignright_contents); 
          newDiv_alignright.appendChild(newDiv_alignright_button);

          newDiv_alignleft.appendChild(newDiv_alignleft_slider);

          newDiv.appendChild(newDiv_alignleft);
          newDiv.appendChild(newDiv_alignright);

          myAppendPosition.appendChild(newDiv);

          // class는 align-right
          let docs = doc.data();

          for(let item in docs){
            if(item == "reserveAddress"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "주소 : " + docs[item];
              myContents[i].appendChild(newP);
            } else if(item == "reserveDate"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "예약 날짜 : " + docs[item];
              myContents[i].appendChild(newP);
            } else if(item == "reserveFiles"){
              var list_Files = docs[item].toString().split(',');
              for(var j=0;j<list_Files.length;j++){
                var newImg = document.createElement("img");
                newImg.setAttribute("src", list_Files[j]);
                newImg.setAttribute("alt", "폐기물 배출 신청" + i);
                myImgSlider[i].appendChild(newImg);
              }
              // TODO : https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js 참고
            } else if(item == "reserveId"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "아이디 : " + docs[item];
              myContents[i].appendChild(newP);
            } else if(item == "reserveItems"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              var str = "";
              for(var j = 0;j < docs[item].length;j++){
                str = str.concat(docs[item][j]);
                if(j != docs[item].length - 1) str = str.concat(", ");
              }
              newP.innerHTML = "항목 : " + str;
              myContents[i].appendChild(newP);
            } else if(item == "reserveState"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "상태 : " + docs[item];
              myContents[i].appendChild(newP);
            } else if(item == "reserveVisitDate"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "방문 희망 날짜 : " + docs[item];
              myContents[i].appendChild(newP);
            } else if(item == "reserveVisitTime"){
              var newP = document.createElement("p");
              newP.setAttribute("id", "mystylecss01");
              newP.innerHTML = "방문 희망 시간 : " + docs[item];
              myContents[i].appendChild(newP);
            } else {
              // ???
            }
          }
          i++;
        });
      } else{
        // doc.data() will be undefined in this case
        console.log("No such doc!!");
      }
    }).catch(function (error) {
      console.log("Error getting document: ", error);
    });

    // TODO : Output ERROR...
    // loadSlider();
  });
</script>
<script type="text/javascript">
  $(document).ready(function(){
    
  });
</script>
</body>
</html>